# Foodgram

## Описание проекта

**Foodgram** — это веб-приложение для публикации и обмена кулинарными рецептами.
Пользователи могут создавать свои рецепты, добавлять их в избранное, подписываться на других авторов и формировать список покупок для выбранных рецептов.
Проект разработан как RESTful API (бэкенд) + SPA (фронтенд) приложение и демонстрирует навыки работы с Django REST Framework, Docker, PostgreSQL и CI/CD.

## Функциональность

- **Аутентификация и профили пользователей**:
  - Регистрация и авторизация через email и пароль.
  - Просмотр и редактирование профиля пользователя.
  - Управление паролем пользователя
  - Подписка на других пользователей для отслеживания их рецептов.

- **Рецепты**:
  - Создание (только авторизованными пользователями), редактирование и удаление рецептов (только авторами).
  - Добавление изображений, ингредиентов (с удобным поиском и указанием их количества) и описания к рецептам, а также указание времени приготовления.

- **Избранное и подписки**:
  - Добавление рецептов в избранное для быстрого доступа.
  - Подписка на авторов, чтобы отслеживать их рецепты.

- **Список покупок**:
  - Формирование списка покупок на основе ингредиентов из выбранных рецептов.
  - Скачивание списка покупок в формате PDF.

- **API**:
  - REST API для работы с пользователями, рецептами, ингредиентами и списком покупок.
  - Документация API доступна по адресу `/api/docs/` после запуска проекта.

- **Админ-панель**:
  - Управление пользователями, рецептами, ингредиентами и тегами через интерфейс Django Admin.

## Требования для запуска

Проект запускается на **Linux**-системе (рекомендуется Ubuntu 20.04 или выше) с установленными следующими инструментами:

- **Docker** и **Docker Compose**:
  - Для контейнеризации и оркестрации сервисов (backend, frontend, nginx, PostgreSQL).
  - Установите с помощью:
    ```bash
    sudo apt-get install docker.io docker-compose
    ```
- **make**:
  - Для выполнения команд `Makefile`.
  - Установите: `sudo apt-get install make`.
- **wget** и **unzip**:
  - Для скачивания и распаковки медиафайлов и статики.
  - Установите: `sudo apt-get install wget unzip`.

## Установка и запуск

### 1. Клонирование репозитория
Склонируйте проект с GitHub:
```bash
git clone https://github.com/NikkZav/foodgram-st.git
cd foodgram-st
```

### 2. Создание конфигурационного файла с переменными окружения (`.env`)
Проект использует файл конфигурации `.env` для настройки окружения. <p>
Создайте его из шаблона `.env.example` при помощи команды:
```bash
make create-env
```

Это скопирует `.env.example` в `.env` с предустановленными значениями:
- `COMPOSE_PROJECT_NAME=foodgram`
- `DATA_ZIP_URL` — ссылка на медиа и статику.
- PostgreSQL: `POSTGRES_USER`, `POSTGRES_PASSWORD`, `POSTGRES_DB`, `DB_HOST=db`, `DB_PORT=5432`.
- Django: `SECRET_KEY`, `ALLOWED_HOSTS`.

> [!TIP]
> Либо создайте .env со всем необходимым самостоятельно

> [!IMPORTANT]
> **Примечание**: Для production рекомендуется заменить `SECRET_KEY` на уникальный ключ.

### 3. Запуск проекта

Проект можно запустить в двух режимах:
- **С предзагруженными данными** (рецепты, изображения, пользователи).
- **Без данных** (только ингредиенты для создания собственных рецептов).

#### Вариант 1: Запуск с предзагруженными данными
```bash
make setup-with-data
```

Эта команда:
1. Скачивает и распаковывает медиафайлы и шрифты из Google Drive.
2. Собирает Docker-образы (`backend`, `frontend`, `nginx`, `db`).
3. Запускает контейнеры.
4. Выполняет миграции базы данных.
5. Загружает фикстуры с тестовыми данными (пользователи, рецепты).

> Чтобы войти от имени пользователей нужны их email-ы и пароли. <p>
> Вот аунтефикационные данные некоторых тестовых пользователей:
> - Админ:
>   - email: `nik.zav.2004.nz@gmail.com`
>   - пароль: `369512345`
> - vasya.ivanov:
>   - email: `vivanov@yandex.ru`
>   - пароль: `MySecretPas$word`

#### Вариант 2: Запуск без предзагруженных данных
```bash
make setup-without-data
```

Эта команда:
1. Собирает и запускает контейнеры.
2. Выполняет миграции.
3. Загружает только список ингредиентов.

### 4. Доступ к приложению
После запуска:
- Веб-интерфейс: `http://localhost/`.
- API: `http://localhost/api/`.
- Документация API: `http://localhost/api/docs/`.
- Админ-панель: `http://localhost/admin/`. Чтобы войти:
  - Либо создайте суперпользователя с помощью `make createsuperuser`, если **_запуск без предзагруженных данных_**
  - Либо используйте уже имеющегося Админ-пользователя из фикстур, если **_запуск с предзагруженными данными_**

### 5. Остановка и очистка
- Остановить контейнеры:
  ```bash
  make stop
  ```
- Полностью удалить контейнеры и тома:
  ```bash
  make delete
  ```

## Дополнительные команды
- Создание суперпользователя:
  ```bash
  make createsuperuser
  ```
- Пересобрать образы:
  ```bash
  make rebuild
  ```
- Выгрузить данные из базы в фикстуры:
  ```bash
  make dumpdata
  ```

## CI/CD
Проект включает GitHub Actions (`.github/workflows/main.yml`):
- Проверка кода линтерами (`ruff`, `pycodestyle`).
- Сборка и пуш Docker-образов (`backend`, `frontend`, `gateway`) на Docker Hub.
- Уведомление в Telegram о успешной сборке.

## Технологии
- **Backend**: Django, Django REST Framework, PostgreSQL.
- **Frontend**: React, Node.js.
- **Инфраструктура**: Docker, Docker Compose, Nginx.
- **CI/CD**: GitHub Actions.
- **Линтеры**: ruff, pycodestyle.